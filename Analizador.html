<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suite de Diagn√≥stico de Hardware</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #0b0e14; color: #cfd8dc; padding: 20px; line-height: 1.6; }
        .container { max-width: 1100px; margin: auto; }
        h1 { text-align: center; color: #00d4ff; text-transform: uppercase; letter-spacing: 2px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 20px; margin-top: 30px; }
        .card { background: #1c2331; border-radius: 12px; padding: 20px; border: 1px solid #334155; transition: 0.3s; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .card:hover { border-color: #00d4ff; transform: translateY(-5px); }
        h3 { margin-top: 0; color: #00d4ff; border-bottom: 1px solid #334155; padding-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .status { background: #05070a; padding: 12px; border-radius: 6px; font-family: 'Courier New', monospace; color: #00ff9d; margin-top: 10px; font-size: 0.95em; min-height: 50px; border: 1px solid #222; }
        .btn { width: 100%; padding: 12px; background: #007bff; border: none; color: white; cursor: pointer; border-radius: 6px; font-weight: bold; transition: 0.2s; }
        .btn:hover { background: #0056b3; }
        video { width: 100%; border-radius: 8px; margin-top: 10px; background: #000; border: 1px solid #444; }
        #pad-area { height: 100px; background: #263238; border: 2px dashed #455a64; border-radius: 8px; display: flex; align-items: center; justify-content: center; cursor: crosshair; }
        .highlight { color: #ffeb3b; }
    </style>
</head>
<body>

<div class="container">
    <h1>Analizador de Sistema y Puertos</h1>

    <div class="grid">
        <div class="card">
            <h3>üì∫ Puerto HDMI / Video</h3>
            <p>Estado de salida de video:</p>
            <div id="hdmi-status" class="status">Analizando pantallas...</div>
        </div>

        <div class="card">
            <h3>üîå Puertos USB</h3>
            <button class="btn" onclick="checkUSB()">Escanear Bus USB</button>
            <div id="usb-status" class="status">Esperando interacci√≥n...</div>
        </div>

        <div class="card">
            <h3>‚å®Ô∏è Entrada de Teclado</h3>
            <p>Presiona cualquier tecla:</p>
            <div id="kb-status" class="status">Puerto listo para recibir...</div>
        </div>

        <div class="card">
            <h3>üì∑ C√°mara (Puerto de Imagen)</h3>
            <button class="btn" onclick="checkCamera()">Probar Sensor</button>
            <video id="vid-preview" autoplay playsinline></video>
        </div>

        <div class="card">
            <h3>üåê Velocidad de Internet</h3>
            <button class="btn" onclick="checkSpeed()">Iniciar Test (10MB)</button>
            <div id="net-status" class="status">Pendiente</div>
        </div>

        <div class="card">
            <h3>üñ±Ô∏è Mousepad / Trackpad</h3>
            <div id="pad-area">Mueve el dedo/puntero aqu√≠</div>
            <div id="pad-status" class="status">Coordenadas: 0, 0</div>
        </div>
    </div>
</div>

<script>
    // --- 1. HDMI / PANTALLAS ---
    function updateScreens() {
        const msg = window.screen.isExtended ? "Detecci√≥n: M√∫ltiples monitores (Puerto HDMI activo)" : "Detecci√≥n: Solo monitor principal activo";
        document.getElementById('hdmi-status').innerText = msg;
    }
    updateScreens();

    // --- 2. USB ---
    async function checkUSB() {
        try {
            const device = await navigator.usb.requestDevice({ filters: [] });
            document.getElementById('usb-status').innerText = `Dispositivo: ${device.productName}\nFabricante: ${device.manufacturerName}`;
        } catch (e) {
            document.getElementById('usb-status').innerText = "Acceso denegado o puerto vac√≠o.";
        }
    }

    // --- 3. TECLADO ---
    window.addEventListener('keydown', (e) => {
        document.getElementById('kb-status').innerHTML = `Puerto activo: <span class="highlight">${e.code}</span><br>Tecla: ${e.key}`;
    });

    // --- 4. C√ÅMARA ---
    async function checkCamera() {
        const v = document.getElementById('vid-preview');
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            v.srcObject = stream;
        } catch (e) {
            alert("Error al acceder al puerto de c√°mara.");
        }
    }

    // --- 5. VELOCIDAD DE INTERNET ---
    async function checkSpeed() {
        const status = document.getElementById('net-status');
        status.innerHTML = "Descargando paquete de prueba...";
        
        const testUrl = "https://speed.cloudflare.com/__down?bytes=10485760"; // 10MB reales
        const startTime = performance.now();
        
        try {
            const response = await fetch(testUrl, { cache: 'no-store' });
            if (!response.ok) throw new Error();
            
            const reader = response.body.getReader();
            let loaded = 0;
            while(true) {
                const {done, value} = await reader.read();
                if (done) break;
                loaded += value.length;
            }

            const endTime = performance.now();
            const duration = (endTime - startTime) / 1000;
            const mbps = ((loaded * 8) / (duration * 1024 * 1024)).toFixed(2);

            status.innerHTML = `LATENCIA: ${Math.round(duration * 10)} ms<br><strong>VELOCIDAD: ${mbps} Mbps</strong>`;
        } catch (e) {
            status.innerText = "Error de conexi√≥n o servidor ocupado.";
        }
    }

    // --- 6. MOUSEPAD ---
    const pad = document.getElementById('pad-area');
    pad.addEventListener('mousemove', (e) => {
        document.getElementById('pad-status').innerText = `X: ${e.offsetX} | Y: ${e.offsetY}`;
    });
</script>

</body>
</html>